      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::TVCL,TVV1,TVV2,TVQ,CL,V1,V2,Q,S1
      REAL(KIND=DPSIZE), POINTER ::IPRED,W,IRES,IWRES,Y,A000032
      REAL(KIND=DPSIZE), POINTER ::A000034,A000036,A000038,A000040
      REAL(KIND=DPSIZE), POINTER ::A000042,A000044,A000046,A000047
      REAL(KIND=DPSIZE), POINTER ::A000048,D000001,D000002,D000003
      REAL(KIND=DPSIZE), POINTER ::D000004,D000005,D000006,D000007
      REAL(KIND=DPSIZE), POINTER ::D000008,D000009,D000010,D000011
      REAL(KIND=DPSIZE), POINTER ::D000012,D000013,D000014,D000064
      REAL(KIND=DPSIZE), POINTER ::D000079,D000078,D000077,D000076
      REAL(KIND=DPSIZE), POINTER ::D000065,D000090,D000091,D000092
      REAL(KIND=DPSIZE), POINTER ::D000062,D000070,D000069,D000061
      REAL(KIND=DPSIZE), POINTER ::D000068,D000202,D000208,D000209
      REAL(KIND=DPSIZE), POINTER ::D000210,D000211,D000201,D000207
      REAL(KIND=DPSIZE), POINTER ::D000206,D000205,D000203,D000212
      REAL(KIND=DPSIZE), POINTER ::D000213,D000204,D000214,D000220
      REAL(KIND=DPSIZE), POINTER ::D000284,D000285,D000286,D000287
      REAL(KIND=DPSIZE), POINTER ::D000219,D000275,D000274,D000273
      REAL(KIND=DPSIZE), POINTER ::D000221,D000292,D000293,D000222
      REAL(KIND=DPSIZE), POINTER ::D000296,D000330,D000356,D000355
      REAL(KIND=DPSIZE), POINTER ::D000354,D000353,D000329,D000346
      REAL(KIND=DPSIZE), POINTER ::D000347,D000348,D000331,D000360
      REAL(KIND=DPSIZE), POINTER ::D000359,D000332,D000362,C000031
      REAL(KIND=DPSIZE), POINTER ::D000364,D000363,D000365,D000366
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      TVCL=>COM(000001);TVV1=>COM(000002);TVV2=>COM(000003)
      TVQ=>COM(000004);CL=>COM(000005);V1=>COM(000006);V2=>COM(000007)
      Q=>COM(000008);S1=>COM(000009);IPRED=>COM(000010);W=>COM(000011)
      IRES=>COM(000012);IWRES=>COM(000013);Y=>COM(000014)
      A000032=>COM(000015);A000034=>COM(000016);A000036=>COM(000017)
      A000038=>COM(000018);A000040=>COM(000019);A000042=>COM(000020)
      A000044=>COM(000021);A000046=>COM(000022);A000047=>COM(000023)
      A000048=>COM(000024);D000001=>COM(000025);D000002=>COM(000026)
      D000003=>COM(000027);D000004=>COM(000028);D000005=>COM(000029)
      D000006=>COM(000030);D000007=>COM(000031);D000008=>COM(000032)
      D000009=>COM(000033);D000010=>COM(000034);D000011=>COM(000035)
      D000012=>COM(000036);D000013=>COM(000037);D000014=>COM(000038)
      D000064=>COM(000039);D000079=>COM(000040);D000078=>COM(000041)
      D000077=>COM(000042);D000076=>COM(000043);D000065=>COM(000044)
      D000090=>COM(000045);D000091=>COM(000046);D000092=>COM(000047)
      D000062=>COM(000048);D000070=>COM(000049);D000069=>COM(000050)
      D000061=>COM(000051);D000068=>COM(000052);D000202=>COM(000053)
      D000208=>COM(000054);D000209=>COM(000055);D000210=>COM(000056)
      D000211=>COM(000057);D000201=>COM(000058);D000207=>COM(000059)
      D000206=>COM(000060);D000205=>COM(000061);D000203=>COM(000062)
      D000212=>COM(000063);D000213=>COM(000064);D000204=>COM(000065)
      D000214=>COM(000066);D000220=>COM(000067);D000284=>COM(000068)
      D000285=>COM(000069);D000286=>COM(000070);D000287=>COM(000071)
      D000219=>COM(000072);D000275=>COM(000073);D000274=>COM(000074)
      D000273=>COM(000075);D000221=>COM(000076);D000292=>COM(000077)
      D000293=>COM(000078);D000222=>COM(000079);D000296=>COM(000080)
      D000330=>COM(000081);D000356=>COM(000082);D000355=>COM(000083)
      D000354=>COM(000084);D000353=>COM(000085);D000329=>COM(000086)
      D000346=>COM(000087);D000347=>COM(000088);D000348=>COM(000089)
      D000331=>COM(000090);D000360=>COM(000091);D000359=>COM(000092)
      D000332=>COM(000093);D000362=>COM(000094);C000031=>COM(000095)
      D000364=>COM(000096);D000363=>COM(000097);D000365=>COM(000098)
      D000366=>COM(000099)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L
      USE NMPRD_INT, ONLY: IQUIT
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   0
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      IDEF(   3,0001)=   5
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      TVCL=THETA(003) 
      TVV1=THETA(004) 
      TVV2=THETA(005) 
      TVQ=THETA(006) 
      B000001=DEXP(ETA(001)) 
      CL=TVCL*B000001 
      B000003=DEXP(ETA(002)) 
      V1=TVV1*B000003 
      B000005=DEXP(ETA(003)) 
      V2=TVV2*B000005 
      B000007=DEXP(ETA(004)) 
      Q=TVQ*B000007 
      S1=V1 
      IF (FIRSTEM == 1) THEN
!                      A000032 = DERIVATIVE OF CL W.R.T. ETA(001)
      A000032=TVCL*B000001 
!                      A000036 = DERIVATIVE OF V1 W.R.T. ETA(002)
      A000036=TVV1*B000003 
!                      A000040 = DERIVATIVE OF V2 W.R.T. ETA(003)
      A000040=TVV2*B000005 
!                      A000044 = DERIVATIVE OF Q W.R.T. ETA(004)
      A000044=TVQ*B000007 
!                      A000047 = DERIVATIVE OF S1 W.R.T. ETA(002)
      A000047=A000036 
      GG(0001,1,1)=CL
      GG(0001,0002,1)=A000032
      GG(0002,1,1)=V1
      GG(0002,0003,1)=A000036
      GG(0003,1,1)=Q
      GG(0003,0005,1)=A000044
      GG(0004,1,1)=V2
      GG(0004,0004,1)=A000040
      GG(0005,1,1)=S1
      GG(0005,0003,1)=A000047
      ELSE
      GG(0001,1,1)=CL
      GG(0002,1,1)=V1
      GG(0003,1,1)=Q
      GG(0004,1,1)=V2
      GG(0005,1,1)=S1
      ENDIF
      IF (MSEC == 1) THEN
!                      A000034 = DERIVATIVE OF A000032 W.R.T. ETA(001)
      A000034=TVCL*B000001 
!                      A000038 = DERIVATIVE OF A000036 W.R.T. ETA(002)
      A000038=TVV1*B000003 
!                      A000042 = DERIVATIVE OF A000040 W.R.T. ETA(003)
      A000042=TVV2*B000005 
!                      A000046 = DERIVATIVE OF A000044 W.R.T. ETA(004)
      A000046=TVQ*B000007 
!                      A000048 = DERIVATIVE OF A000047 W.R.T. ETA(002)
      A000048=A000038 
      GG(0001,0002,0002)=A000034
      GG(0002,0003,0003)=A000038
      GG(0003,0005,0005)=A000046
      GG(0004,0004,0004)=A000042
      GG(0005,0003,0003)=A000048
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE PROCM_REAL,ONLY: TSTATE
      USE PROCM_REAL,ONLY: A=>AMNT,DAETA,D2AETA
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=-1
      IDEF(3)=001
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
 !  level            0
      DV=EVTREC(NVNT,004)
      IPRED=A(1)/V1 
      B000008=THETA(001)**2 
      B000009=THETA(002)**2 
      B000010=IPRED**2 
      B000011=B000008+B000009*B000010 
      B000012=DSQRT(B000011) 
      W=B000012 
      IRES=DV-IPRED 
      IWRES=IRES/W 
      Y=IPRED+W*EPS(001) 
!                      C000031 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000031=W 
      IF (FIRSTEM == 1) THEN !1
      B000001=1.D0/V1 
!                      D000061 = DERIVATIVE OF IPRED W.R.T. ETA(004)
      D000061=B000001*DAETA(001,004) 
!                      D000062 = DERIVATIVE OF IPRED W.R.T. ETA(003)
      D000062=B000001*DAETA(001,003) 
!                      D000063 = DERIVATIVE OF IPRED W.R.T. ETA(002)
      D000063=B000001*DAETA(001,002) 
!                      D000064 = DERIVATIVE OF IPRED W.R.T. ETA(001)
      D000064=B000001*DAETA(001,001) 
      B000002=-A(1)/V1/V1 
!                      D000065 = DERIVATIVE OF IPRED W.R.T. ETA(002)
      D000065=B000002*A000036+D000063 
      B000014=IPRED*2D0 
!                      D000095 = DERIVATIVE OF B000010 W.R.T. ETA(002)
      D000095=B000014*D000065 
!                      D000096 = DERIVATIVE OF B000010 W.R.T. ETA(001)
      D000096=B000014*D000064 
!                      D000097 = DERIVATIVE OF B000010 W.R.T. ETA(003)
      D000097=B000014*D000062 
!                      D000098 = DERIVATIVE OF B000010 W.R.T. ETA(004)
      D000098=B000014*D000061 
!                      D000103 = DERIVATIVE OF B000011 W.R.T. ETA(004)
      D000103=B000009*D000098 
!                      D000104 = DERIVATIVE OF B000011 W.R.T. ETA(003)
      D000104=B000009*D000097 
!                      D000105 = DERIVATIVE OF B000011 W.R.T. ETA(001)
      D000105=B000009*D000096 
!                      D000106 = DERIVATIVE OF B000011 W.R.T. ETA(002)
      D000106=B000009*D000095 
      B000016=.5D0/B000012 
!                      D000107 = DERIVATIVE OF B000012 W.R.T. ETA(002)
      D000107=B000016*D000106 
!                      D000108 = DERIVATIVE OF B000012 W.R.T. ETA(001)
      D000108=B000016*D000105 
!                      D000109 = DERIVATIVE OF B000012 W.R.T. ETA(003)
      D000109=B000016*D000104 
!                      D000110 = DERIVATIVE OF B000012 W.R.T. ETA(004)
      D000110=B000016*D000103 
!                      D000201 = DERIVATIVE OF IRES W.R.T. ETA(002)
      D000201=-D000065 
!                      D000202 = DERIVATIVE OF IRES W.R.T. ETA(001)
      D000202=-D000064 
!                      D000203 = DERIVATIVE OF IRES W.R.T. ETA(003)
      D000203=-D000062 
!                      D000204 = DERIVATIVE OF IRES W.R.T. ETA(004)
      D000204=-D000061 
      B000018=1.D0/W 
!                      D000215 = DERIVATIVE OF IWRES W.R.T. ETA(004)
      D000215=B000018*D000204 
!                      D000216 = DERIVATIVE OF IWRES W.R.T. ETA(003)
      D000216=B000018*D000203 
!                      D000217 = DERIVATIVE OF IWRES W.R.T. ETA(001)
      D000217=B000018*D000202 
!                      D000218 = DERIVATIVE OF IWRES W.R.T. ETA(002)
      D000218=B000018*D000201 
      B000019=-IRES/W/W 
!                      D000219 = DERIVATIVE OF IWRES W.R.T. ETA(002)
      D000219=B000019*D000107+D000218 
!                      D000220 = DERIVATIVE OF IWRES W.R.T. ETA(001)
      D000220=B000019*D000108+D000217 
!                      D000221 = DERIVATIVE OF IWRES W.R.T. ETA(003)
      D000221=B000019*D000109+D000216 
!                      D000222 = DERIVATIVE OF IWRES W.R.T. ETA(004)
      D000222=B000019*D000110+D000215 
!                      D000325 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000325=D000065 
!                      D000326 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000326=D000064 
!                      D000327 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000327=D000062 
!                      D000328 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000328=D000061 
!                      D000329 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000329=EPS(001)*D000107+D000325 
!                      D000330 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000330=EPS(001)*D000108+D000326 
!                      D000331 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000331=EPS(001)*D000109+D000327 
!                      D000332 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000332=EPS(001)*D000110+D000328 
!                      D000363 = DERIVATIVE OF C000031 W.R.T. ETA(002)
      D000363=D000107 
!                      D000364 = DERIVATIVE OF C000031 W.R.T. ETA(001)
      D000364=D000108 
!                      D000365 = DERIVATIVE OF C000031 W.R.T. ETA(003)
      D000365=D000109 
!                      D000366 = DERIVATIVE OF C000031 W.R.T. ETA(004)
      D000366=D000110 
      G(001,1)=D000330
      G(002,1)=D000329
      G(003,1)=D000331
      G(004,1)=D000332
      ENDIF !1
      HH(001,1)=C000031
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000364
      HH(001,003)=D000363
      HH(001,004)=D000365
      HH(001,005)=D000366
      ENDIF !2
      IF (MSEC == 1) THEN
      B000004=-1.D0/V1/V1 
!                      D000067 = DERIVATIVE OF B000001 W.R.T. ETA(002)
      D000067=B000004*A000036 
!                      D000068 = DERIVATIVE OF D000061 W.R.T. ETA(004)
      D000068=B000001*D2AETA(001,004,004) 
!                      D000069 = DERIVATIVE OF D000062 W.R.T. ETA(004)
      D000069=B000001*D2AETA(001,004,003) 
!                      D000070 = DERIVATIVE OF D000062 W.R.T. ETA(003)
      D000070=B000001*D2AETA(001,003,003) 
!                      D000071 = DERIVATIVE OF D000063 W.R.T. ETA(002)
      D000071=DAETA(001,002)*D000067 
!                      D000072 = DERIVATIVE OF D000063 W.R.T. ETA(004)
      D000072=B000001*D2AETA(001,004,002) 
!                      D000073 = DERIVATIVE OF D000063 W.R.T. ETA(003)
      D000073=B000001*D2AETA(001,003,002) 
!                      D000074 = DERIVATIVE OF D000063 W.R.T. ETA(002)
      D000074=B000001*D2AETA(001,002,002)+D000071 
!                      D000075 = DERIVATIVE OF D000064 W.R.T. ETA(002)
      D000075=DAETA(001,001)*D000067 
!                      D000076 = DERIVATIVE OF D000064 W.R.T. ETA(004)
      D000076=B000001*D2AETA(001,004,001) 
!                      D000077 = DERIVATIVE OF D000064 W.R.T. ETA(003)
      D000077=B000001*D2AETA(001,003,001) 
!                      D000078 = DERIVATIVE OF D000064 W.R.T. ETA(002)
      D000078=B000001*D2AETA(001,002,001)+D000075 
!                      D000079 = DERIVATIVE OF D000064 W.R.T. ETA(001)
      D000079=B000001*D2AETA(001,001,001) 
      B000005=-1.D0/V1/V1 
!                      D000080 = DERIVATIVE OF B000002 W.R.T. ETA(004)
      D000080=B000005*DAETA(001,004) 
!                      D000081 = DERIVATIVE OF B000002 W.R.T. ETA(003)
      D000081=B000005*DAETA(001,003) 
!                      D000082 = DERIVATIVE OF B000002 W.R.T. ETA(002)
      D000082=B000005*DAETA(001,002) 
!                      D000083 = DERIVATIVE OF B000002 W.R.T. ETA(001)
      D000083=B000005*DAETA(001,001) 
      B000006=A(1)/V1/V1/V1 
!                      D000084 = DERIVATIVE OF B000002 W.R.T. ETA(002)
      D000084=B000006*A000036+D000082 
      B000007=A(1)/V1/V1/V1 
!                      D000085 = DERIVATIVE OF B000002 W.R.T. ETA(002)
      D000085=B000007*A000036+D000084 
!                      D000086 = DERIVATIVE OF D000065 W.R.T. ETA(002)
      D000086=A000036*D000085 
!                      D000087 = DERIVATIVE OF D000065 W.R.T. ETA(003)
      D000087=A000036*D000081 
!                      D000088 = DERIVATIVE OF D000065 W.R.T. ETA(004)
      D000088=A000036*D000080 
!                      D000089 = DERIVATIVE OF D000065 W.R.T. ETA(002)
      D000089=B000002*A000038+D000086 
!                      D000090 = DERIVATIVE OF D000065 W.R.T. ETA(002)
      D000090=D000074+D000089 
!                      D000091 = DERIVATIVE OF D000065 W.R.T. ETA(003)
      D000091=D000073+D000087 
!                      D000092 = DERIVATIVE OF D000065 W.R.T. ETA(004)
      D000092=D000072+D000088 
!                      D000119 = DERIVATIVE OF B000014 W.R.T. ETA(001)
      D000119=2D0*D000064 
!                      D000120 = DERIVATIVE OF B000014 W.R.T. ETA(002)
      D000120=2D0*D000065 
!                      D000121 = DERIVATIVE OF B000014 W.R.T. ETA(003)
      D000121=2D0*D000062 
!                      D000122 = DERIVATIVE OF B000014 W.R.T. ETA(004)
      D000122=2D0*D000061 
!                      D000123 = DERIVATIVE OF D000095 W.R.T. ETA(004)
      D000123=D000065*D000122 
!                      D000124 = DERIVATIVE OF D000095 W.R.T. ETA(003)
      D000124=D000065*D000121 
!                      D000125 = DERIVATIVE OF D000095 W.R.T. ETA(002)
      D000125=D000065*D000120 
!                      D000126 = DERIVATIVE OF D000095 W.R.T. ETA(004)
      D000126=B000014*D000092+D000123 
!                      D000127 = DERIVATIVE OF D000095 W.R.T. ETA(003)
      D000127=B000014*D000091+D000124 
!                      D000128 = DERIVATIVE OF D000095 W.R.T. ETA(002)
      D000128=B000014*D000090+D000125 
!                      D000129 = DERIVATIVE OF D000096 W.R.T. ETA(004)
      D000129=D000064*D000122 
!                      D000130 = DERIVATIVE OF D000096 W.R.T. ETA(003)
      D000130=D000064*D000121 
!                      D000131 = DERIVATIVE OF D000096 W.R.T. ETA(002)
      D000131=D000064*D000120 
!                      D000132 = DERIVATIVE OF D000096 W.R.T. ETA(001)
      D000132=D000064*D000119 
!                      D000133 = DERIVATIVE OF D000096 W.R.T. ETA(001)
      D000133=B000014*D000079+D000132 
!                      D000134 = DERIVATIVE OF D000096 W.R.T. ETA(002)
      D000134=B000014*D000078+D000131 
!                      D000135 = DERIVATIVE OF D000096 W.R.T. ETA(003)
      D000135=B000014*D000077+D000130 
!                      D000136 = DERIVATIVE OF D000096 W.R.T. ETA(004)
      D000136=B000014*D000076+D000129 
!                      D000137 = DERIVATIVE OF D000097 W.R.T. ETA(004)
      D000137=D000062*D000122 
!                      D000138 = DERIVATIVE OF D000097 W.R.T. ETA(003)
      D000138=D000062*D000121 
!                      D000139 = DERIVATIVE OF D000097 W.R.T. ETA(003)
      D000139=B000014*D000070+D000138 
!                      D000140 = DERIVATIVE OF D000097 W.R.T. ETA(004)
      D000140=B000014*D000069+D000137 
!                      D000141 = DERIVATIVE OF D000098 W.R.T. ETA(004)
      D000141=D000061*D000122 
!                      D000142 = DERIVATIVE OF D000098 W.R.T. ETA(004)
      D000142=B000014*D000068+D000141 
!                      D000157 = DERIVATIVE OF D000103 W.R.T. ETA(004)
      D000157=B000009*D000142 
!                      D000158 = DERIVATIVE OF D000104 W.R.T. ETA(004)
      D000158=B000009*D000140 
!                      D000159 = DERIVATIVE OF D000104 W.R.T. ETA(003)
      D000159=B000009*D000139 
!                      D000160 = DERIVATIVE OF D000105 W.R.T. ETA(004)
      D000160=B000009*D000136 
!                      D000161 = DERIVATIVE OF D000105 W.R.T. ETA(003)
      D000161=B000009*D000135 
!                      D000162 = DERIVATIVE OF D000105 W.R.T. ETA(002)
      D000162=B000009*D000134 
!                      D000163 = DERIVATIVE OF D000105 W.R.T. ETA(001)
      D000163=B000009*D000133 
!                      D000164 = DERIVATIVE OF D000106 W.R.T. ETA(002)
      D000164=B000009*D000128 
!                      D000165 = DERIVATIVE OF D000106 W.R.T. ETA(003)
      D000165=B000009*D000127 
!                      D000166 = DERIVATIVE OF D000106 W.R.T. ETA(004)
      D000166=B000009*D000126 
      B000017=-.5D0/B000012/B000012 
!                      D000167 = DERIVATIVE OF B000016 W.R.T. ETA(004)
      D000167=B000017*D000110 
!                      D000168 = DERIVATIVE OF B000016 W.R.T. ETA(003)
      D000168=B000017*D000109 
!                      D000169 = DERIVATIVE OF B000016 W.R.T. ETA(001)
      D000169=B000017*D000108 
!                      D000170 = DERIVATIVE OF B000016 W.R.T. ETA(002)
      D000170=B000017*D000107 
!                      D000171 = DERIVATIVE OF D000107 W.R.T. ETA(002)
      D000171=D000106*D000170 
!                      D000172 = DERIVATIVE OF D000107 W.R.T. ETA(003)
      D000172=D000106*D000168 
!                      D000173 = DERIVATIVE OF D000107 W.R.T. ETA(004)
      D000173=D000106*D000167 
!                      D000174 = DERIVATIVE OF D000107 W.R.T. ETA(004)
      D000174=B000016*D000166+D000173 
!                      D000175 = DERIVATIVE OF D000107 W.R.T. ETA(003)
      D000175=B000016*D000165+D000172 
!                      D000176 = DERIVATIVE OF D000107 W.R.T. ETA(002)
      D000176=B000016*D000164+D000171 
!                      D000177 = DERIVATIVE OF D000108 W.R.T. ETA(002)
      D000177=D000105*D000170 
!                      D000178 = DERIVATIVE OF D000108 W.R.T. ETA(001)
      D000178=D000105*D000169 
!                      D000179 = DERIVATIVE OF D000108 W.R.T. ETA(003)
      D000179=D000105*D000168 
!                      D000180 = DERIVATIVE OF D000108 W.R.T. ETA(004)
      D000180=D000105*D000167 
!                      D000181 = DERIVATIVE OF D000108 W.R.T. ETA(001)
      D000181=B000016*D000163+D000178 
!                      D000182 = DERIVATIVE OF D000108 W.R.T. ETA(002)
      D000182=B000016*D000162+D000177 
!                      D000183 = DERIVATIVE OF D000108 W.R.T. ETA(003)
      D000183=B000016*D000161+D000179 
!                      D000184 = DERIVATIVE OF D000108 W.R.T. ETA(004)
      D000184=B000016*D000160+D000180 
!                      D000185 = DERIVATIVE OF D000109 W.R.T. ETA(003)
      D000185=D000104*D000168 
!                      D000186 = DERIVATIVE OF D000109 W.R.T. ETA(004)
      D000186=D000104*D000167 
!                      D000187 = DERIVATIVE OF D000109 W.R.T. ETA(003)
      D000187=B000016*D000159+D000185 
!                      D000188 = DERIVATIVE OF D000109 W.R.T. ETA(004)
      D000188=B000016*D000158+D000186 
!                      D000189 = DERIVATIVE OF D000110 W.R.T. ETA(004)
      D000189=D000103*D000167 
!                      D000190 = DERIVATIVE OF D000110 W.R.T. ETA(004)
      D000190=B000016*D000157+D000189 
!                      D000205 = DERIVATIVE OF D000201 W.R.T. ETA(004)
      D000205=-D000092 
!                      D000206 = DERIVATIVE OF D000201 W.R.T. ETA(003)
      D000206=-D000091 
!                      D000207 = DERIVATIVE OF D000201 W.R.T. ETA(002)
      D000207=-D000090 
!                      D000208 = DERIVATIVE OF D000202 W.R.T. ETA(001)
      D000208=-D000079 
!                      D000209 = DERIVATIVE OF D000202 W.R.T. ETA(002)
      D000209=-D000078 
!                      D000210 = DERIVATIVE OF D000202 W.R.T. ETA(003)
      D000210=-D000077 
!                      D000211 = DERIVATIVE OF D000202 W.R.T. ETA(004)
      D000211=-D000076 
!                      D000212 = DERIVATIVE OF D000203 W.R.T. ETA(003)
      D000212=-D000070 
!                      D000213 = DERIVATIVE OF D000203 W.R.T. ETA(004)
      D000213=-D000069 
!                      D000214 = DERIVATIVE OF D000204 W.R.T. ETA(004)
      D000214=-D000068 
      B000022=-1.D0/W/W 
!                      D000231 = DERIVATIVE OF B000018 W.R.T. ETA(004)
      D000231=B000022*D000110 
!                      D000232 = DERIVATIVE OF B000018 W.R.T. ETA(003)
      D000232=B000022*D000109 
!                      D000233 = DERIVATIVE OF B000018 W.R.T. ETA(002)
      D000233=B000022*D000107 
!                      D000234 = DERIVATIVE OF B000018 W.R.T. ETA(001)
      D000234=B000022*D000108 
!                      D000235 = DERIVATIVE OF D000215 W.R.T. ETA(004)
      D000235=D000204*D000231 
!                      D000236 = DERIVATIVE OF D000215 W.R.T. ETA(004)
      D000236=B000018*D000214+D000235 
!                      D000237 = DERIVATIVE OF D000216 W.R.T. ETA(003)
      D000237=D000203*D000232 
!                      D000238 = DERIVATIVE OF D000216 W.R.T. ETA(004)
      D000238=D000203*D000231 
!                      D000239 = DERIVATIVE OF D000216 W.R.T. ETA(004)
      D000239=B000018*D000213+D000238 
!                      D000240 = DERIVATIVE OF D000216 W.R.T. ETA(003)
      D000240=B000018*D000212+D000237 
!                      D000241 = DERIVATIVE OF D000217 W.R.T. ETA(001)
      D000241=D000202*D000234 
!                      D000242 = DERIVATIVE OF D000217 W.R.T. ETA(002)
      D000242=D000202*D000233 
!                      D000243 = DERIVATIVE OF D000217 W.R.T. ETA(003)
      D000243=D000202*D000232 
!                      D000244 = DERIVATIVE OF D000217 W.R.T. ETA(004)
      D000244=D000202*D000231 
!                      D000245 = DERIVATIVE OF D000217 W.R.T. ETA(004)
      D000245=B000018*D000211+D000244 
!                      D000246 = DERIVATIVE OF D000217 W.R.T. ETA(003)
      D000246=B000018*D000210+D000243 
!                      D000247 = DERIVATIVE OF D000217 W.R.T. ETA(002)
      D000247=B000018*D000209+D000242 
!                      D000248 = DERIVATIVE OF D000217 W.R.T. ETA(001)
      D000248=B000018*D000208+D000241 
!                      D000249 = DERIVATIVE OF D000218 W.R.T. ETA(002)
      D000249=D000201*D000233 
!                      D000250 = DERIVATIVE OF D000218 W.R.T. ETA(003)
      D000250=D000201*D000232 
!                      D000251 = DERIVATIVE OF D000218 W.R.T. ETA(004)
      D000251=D000201*D000231 
!                      D000252 = DERIVATIVE OF D000218 W.R.T. ETA(002)
      D000252=B000018*D000207+D000249 
!                      D000253 = DERIVATIVE OF D000218 W.R.T. ETA(003)
      D000253=B000018*D000206+D000250 
!                      D000254 = DERIVATIVE OF D000218 W.R.T. ETA(004)
      D000254=B000018*D000205+D000251 
      B000023=-1.D0/W/W 
!                      D000255 = DERIVATIVE OF B000019 W.R.T. ETA(004)
      D000255=B000023*D000204 
!                      D000256 = DERIVATIVE OF B000019 W.R.T. ETA(003)
      D000256=B000023*D000203 
!                      D000257 = DERIVATIVE OF B000019 W.R.T. ETA(002)
      D000257=B000023*D000201 
!                      D000258 = DERIVATIVE OF B000019 W.R.T. ETA(001)
      D000258=B000023*D000202 
      B000024=IRES/W/W/W 
!                      D000259 = DERIVATIVE OF B000019 W.R.T. ETA(004)
      D000259=B000024*D000110+D000255 
!                      D000260 = DERIVATIVE OF B000019 W.R.T. ETA(003)
      D000260=B000024*D000109+D000256 
!                      D000261 = DERIVATIVE OF B000019 W.R.T. ETA(002)
      D000261=B000024*D000107+D000257 
!                      D000262 = DERIVATIVE OF B000019 W.R.T. ETA(001)
      D000262=B000024*D000108+D000258 
      B000025=IRES/W/W/W 
!                      D000263 = DERIVATIVE OF B000019 W.R.T. ETA(004)
      D000263=B000025*D000110+D000259 
!                      D000264 = DERIVATIVE OF B000019 W.R.T. ETA(003)
      D000264=B000025*D000109+D000260 
!                      D000265 = DERIVATIVE OF B000019 W.R.T. ETA(002)
      D000265=B000025*D000107+D000261 
!                      D000266 = DERIVATIVE OF B000019 W.R.T. ETA(001)
      D000266=B000025*D000108+D000262 
!                      D000267 = DERIVATIVE OF D000219 W.R.T. ETA(002)
      D000267=D000107*D000265 
!                      D000268 = DERIVATIVE OF D000219 W.R.T. ETA(003)
      D000268=D000107*D000264 
!                      D000269 = DERIVATIVE OF D000219 W.R.T. ETA(004)
      D000269=D000107*D000263 
!                      D000270 = DERIVATIVE OF D000219 W.R.T. ETA(004)
      D000270=B000019*D000174+D000269 
!                      D000271 = DERIVATIVE OF D000219 W.R.T. ETA(003)
      D000271=B000019*D000175+D000268 
!                      D000272 = DERIVATIVE OF D000219 W.R.T. ETA(002)
      D000272=B000019*D000176+D000267 
!                      D000273 = DERIVATIVE OF D000219 W.R.T. ETA(004)
      D000273=D000254+D000270 
!                      D000274 = DERIVATIVE OF D000219 W.R.T. ETA(003)
      D000274=D000253+D000271 
!                      D000275 = DERIVATIVE OF D000219 W.R.T. ETA(002)
      D000275=D000252+D000272 
!                      D000276 = DERIVATIVE OF D000220 W.R.T. ETA(001)
      D000276=D000108*D000266 
!                      D000277 = DERIVATIVE OF D000220 W.R.T. ETA(002)
      D000277=D000108*D000265 
!                      D000278 = DERIVATIVE OF D000220 W.R.T. ETA(003)
      D000278=D000108*D000264 
!                      D000279 = DERIVATIVE OF D000220 W.R.T. ETA(004)
      D000279=D000108*D000263 
!                      D000280 = DERIVATIVE OF D000220 W.R.T. ETA(001)
      D000280=B000019*D000181+D000276 
!                      D000281 = DERIVATIVE OF D000220 W.R.T. ETA(002)
      D000281=B000019*D000182+D000277 
!                      D000282 = DERIVATIVE OF D000220 W.R.T. ETA(003)
      D000282=B000019*D000183+D000278 
!                      D000283 = DERIVATIVE OF D000220 W.R.T. ETA(004)
      D000283=B000019*D000184+D000279 
!                      D000284 = DERIVATIVE OF D000220 W.R.T. ETA(001)
      D000284=D000248+D000280 
!                      D000285 = DERIVATIVE OF D000220 W.R.T. ETA(002)
      D000285=D000247+D000281 
!                      D000286 = DERIVATIVE OF D000220 W.R.T. ETA(003)
      D000286=D000246+D000282 
!                      D000287 = DERIVATIVE OF D000220 W.R.T. ETA(004)
      D000287=D000245+D000283 
!                      D000288 = DERIVATIVE OF D000221 W.R.T. ETA(003)
      D000288=D000109*D000264 
!                      D000289 = DERIVATIVE OF D000221 W.R.T. ETA(004)
      D000289=D000109*D000263 
!                      D000290 = DERIVATIVE OF D000221 W.R.T. ETA(003)
      D000290=B000019*D000187+D000288 
!                      D000291 = DERIVATIVE OF D000221 W.R.T. ETA(004)
      D000291=B000019*D000188+D000289 
!                      D000292 = DERIVATIVE OF D000221 W.R.T. ETA(003)
      D000292=D000240+D000290 
!                      D000293 = DERIVATIVE OF D000221 W.R.T. ETA(004)
      D000293=D000239+D000291 
!                      D000294 = DERIVATIVE OF D000222 W.R.T. ETA(004)
      D000294=D000110*D000263 
!                      D000295 = DERIVATIVE OF D000222 W.R.T. ETA(004)
      D000295=B000019*D000190+D000294 
!                      D000296 = DERIVATIVE OF D000222 W.R.T. ETA(004)
      D000296=D000236+D000295 
!                      D000333 = DERIVATIVE OF D000325 W.R.T. ETA(004)
      D000333=D000092 
!                      D000334 = DERIVATIVE OF D000325 W.R.T. ETA(003)
      D000334=D000091 
!                      D000335 = DERIVATIVE OF D000325 W.R.T. ETA(002)
      D000335=D000090 
!                      D000336 = DERIVATIVE OF D000326 W.R.T. ETA(001)
      D000336=D000079 
!                      D000337 = DERIVATIVE OF D000326 W.R.T. ETA(002)
      D000337=D000078 
!                      D000338 = DERIVATIVE OF D000326 W.R.T. ETA(003)
      D000338=D000077 
!                      D000339 = DERIVATIVE OF D000326 W.R.T. ETA(004)
      D000339=D000076 
!                      D000340 = DERIVATIVE OF D000327 W.R.T. ETA(003)
      D000340=D000070 
!                      D000341 = DERIVATIVE OF D000327 W.R.T. ETA(004)
      D000341=D000069 
!                      D000342 = DERIVATIVE OF D000328 W.R.T. ETA(004)
      D000342=D000068 
!                      D000343 = DERIVATIVE OF D000329 W.R.T. ETA(004)
      D000343=EPS(001)*D000174 
!                      D000344 = DERIVATIVE OF D000329 W.R.T. ETA(003)
      D000344=EPS(001)*D000175 
!                      D000345 = DERIVATIVE OF D000329 W.R.T. ETA(002)
      D000345=EPS(001)*D000176 
!                      D000346 = DERIVATIVE OF D000329 W.R.T. ETA(002)
      D000346=D000335+D000345 
!                      D000347 = DERIVATIVE OF D000329 W.R.T. ETA(003)
      D000347=D000334+D000344 
!                      D000348 = DERIVATIVE OF D000329 W.R.T. ETA(004)
      D000348=D000333+D000343 
!                      D000349 = DERIVATIVE OF D000330 W.R.T. ETA(001)
      D000349=EPS(001)*D000181 
!                      D000350 = DERIVATIVE OF D000330 W.R.T. ETA(002)
      D000350=EPS(001)*D000182 
!                      D000351 = DERIVATIVE OF D000330 W.R.T. ETA(003)
      D000351=EPS(001)*D000183 
!                      D000352 = DERIVATIVE OF D000330 W.R.T. ETA(004)
      D000352=EPS(001)*D000184 
!                      D000353 = DERIVATIVE OF D000330 W.R.T. ETA(004)
      D000353=D000339+D000352 
!                      D000354 = DERIVATIVE OF D000330 W.R.T. ETA(003)
      D000354=D000338+D000351 
!                      D000355 = DERIVATIVE OF D000330 W.R.T. ETA(002)
      D000355=D000337+D000350 
!                      D000356 = DERIVATIVE OF D000330 W.R.T. ETA(001)
      D000356=D000336+D000349 
!                      D000357 = DERIVATIVE OF D000331 W.R.T. ETA(003)
      D000357=EPS(001)*D000187 
!                      D000358 = DERIVATIVE OF D000331 W.R.T. ETA(004)
      D000358=EPS(001)*D000188 
!                      D000359 = DERIVATIVE OF D000331 W.R.T. ETA(004)
      D000359=D000341+D000358 
!                      D000360 = DERIVATIVE OF D000331 W.R.T. ETA(003)
      D000360=D000340+D000357 
!                      D000361 = DERIVATIVE OF D000332 W.R.T. ETA(004)
      D000361=EPS(001)*D000190 
!                      D000362 = DERIVATIVE OF D000332 W.R.T. ETA(004)
      D000362=D000342+D000361 
      G(001,002)=D000356
      G(002,002)=D000355
      G(002,003)=D000346
      G(003,002)=D000354
      G(003,003)=D000347
      G(003,004)=D000360
      G(004,002)=D000353
      G(004,003)=D000348
      G(004,004)=D000359
      G(004,005)=D000362
      ENDIF
      F=Y
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=6
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=5
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=17
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=12
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=1
      NAME_FSIZES(29)='PD'; F_SIZES(29)=18
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=4
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=7
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=9
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=6
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=4
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=1
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=6
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L
      USE NMPRD_INT, ONLY: IQUIT
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
